<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to pylocker’s documentation! &#8212; PYthon LOCKER package. pylocker v0.0.1</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PYthon LOCKER package. pylocker v0.0.1" href="#" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-pylocker">
<span id="welcome-to-pylocker-s-documentation"></span><h1>Welcome to pylocker&#8217;s documentation!<a class="headerlink" href="#module-pylocker" title="Permalink to this headline">¶</a></h1>
<p>PYthon LOCKER or pylocker package provides a pythonic way to create locking system that 
can be used for general purposes as well as for locking files upon reading or writing. 
The locking system works by creating and updating a general locking file anytime a lock 
is requested with a certain pass. Lock pass is used to specify the user who sets the 
lock and who can have access to whatever is locked. Any user who knows the lock pass can
access whatever is locked.</p>
<div class="section" id="installation-guide">
<h2>Installation guide:<a class="headerlink" href="#installation-guide" title="Permalink to this headline">¶</a></h2>
<p>pylocker is a pure python 2.7.x module that needs no particular installation. One can 
either fork pylocker&#8217;s <a class="reference external" href="https://github.com/bachiraoun/pylocker/">github repository</a> 
and copy the package to python&#8217;s site-packages or use pip as the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">pip install pylocker</span>
</pre></div>
</div>
</div>
<div class="section" id="package-functions">
<h2>Package Functions:<a class="headerlink" href="#package-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pylocker.get_version">
<code class="descclassname">pylocker.</code><code class="descname">get_version</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pylocker.get_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pylocker&#8217;s version number.</p>
</dd></dl>

<dl class="function">
<dt id="pylocker.get_author">
<code class="descclassname">pylocker.</code><code class="descname">get_author</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pylocker.get_author" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pylocker&#8217;s author&#8217;s name.</p>
</dd></dl>

<dl class="function">
<dt id="pylocker.get_email">
<code class="descclassname">pylocker.</code><code class="descname">get_email</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pylocker.get_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pylocker&#8217;s author&#8217;s email.</p>
</dd></dl>

<dl class="function">
<dt id="pylocker.get_doc">
<code class="descclassname">pylocker.</code><code class="descname">get_doc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pylocker.get_doc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pyrep&#8217;s official online documentation link.</p>
</dd></dl>

<dl class="function">
<dt id="pylocker.get_repository">
<code class="descclassname">pylocker.</code><code class="descname">get_repository</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pylocker.get_repository" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pylocker&#8217;s official online repository link.</p>
</dd></dl>

<dl class="function">
<dt id="pylocker.get_pypi">
<code class="descclassname">pylocker.</code><code class="descname">get_pypi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pylocker.get_pypi" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pylocker pypi&#8217;s link.</p>
</dd></dl>

</div>
<div class="section" id="usage">
<h2>Usage:<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>This example shows how to use pylocker in the most general way. We won&#8217;t be locking 
a file but aquiring a lock and testing if for doing whatever we want.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">pylocker</span> <span class="kn">import</span> <span class="n">Locker</span>

<span class="c1">#  create a unique lock pass. This can be any string.</span>
<span class="n">lpass</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>

<span class="c1"># create locker instance.</span>
<span class="n">FL</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">filePath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lockPass</span><span class="o">=</span><span class="n">lpass</span><span class="p">)</span>

<span class="c1"># try to aquire the lock</span>
<span class="n">aquired</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">FL</span><span class="o">.</span><span class="n">acquire_lock</span><span class="p">()</span>

<span class="c1"># check if aquired.</span>
<span class="k">if</span> <span class="n">aquired</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Lock aquired&quot;</span>
    <span class="k">print</span> <span class="s2">&quot;In this if statement block I can do whatever I want before releasing the lock&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Unable to aquire the lock. exit code </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">code</span>
    <span class="k">print</span> <span class="s2">&quot;keep this block empty as the lock was not acquired&quot;</span>

<span class="c1"># now release the lock.</span>
<span class="n">FL</span><span class="o">.</span><span class="n">release_lock</span><span class="p">()</span>
</pre></div>
</div>
<p>The above example can also be done using &#8216;with&#8217; statement</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">pylocker</span> <span class="kn">import</span> <span class="n">Locker</span>

<span class="c1">#  create a unique lock pass. This can be any string.</span>
<span class="n">lpass</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>

<span class="c1"># create locker instance</span>
<span class="n">FL</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">filePath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lockPass</span><span class="o">=</span><span class="n">lpass</span><span class="p">)</span>

<span class="c1"># aquire the lock</span>
<span class="k">with</span> <span class="n">FL</span> <span class="k">as</span> <span class="n">r</span><span class="p">:</span>
    <span class="c1"># r is a tuple of three items. the aquired result, the aquiring code and </span>
    <span class="c1"># a file descriptor fd. fd will always be None when filePath is None.  </span>
    <span class="c1"># Otherwise fd can be a real opened file descriptor when acquired is </span>
    <span class="c1"># True. In this particular case fd is always None regardless whether </span>
    <span class="c1"># the lock was successfully aquired or not because filePath is None.</span>
    <span class="n">acquired</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">fd</span>  <span class="o">=</span> <span class="n">r</span>
    
     
    <span class="c1"># check if aquired.</span>
    <span class="k">if</span> <span class="n">acquired</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;Lock aquired, in this if statement do whatever you want&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;Unable to aquire the lock. exit code </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">code</span>

<span class="c1"># no need to release anything because with statement takes care of that.</span>
</pre></div>
</div>
<p>Now let&#8217;s lock a file using &#8216;with&#8217; statement</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">pylocker</span> <span class="kn">import</span> <span class="n">Locker</span>

<span class="c1">#  create a unique lock pass. This can be any string.</span>
<span class="n">lpass</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>

<span class="c1"># create locker instance.</span>
<span class="n">FL</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">filePath</span><span class="o">=</span><span class="s1">&#39;myfile.txt&#39;</span><span class="p">,</span> <span class="n">lockPass</span><span class="o">=</span><span class="n">lpass</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="c1"># aquire the lock</span>
<span class="k">with</span> <span class="n">FL</span> <span class="k">as</span> <span class="n">r</span><span class="p">:</span>
    <span class="c1"># get the result</span>
    <span class="n">acquired</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">fd</span>  <span class="o">=</span> <span class="n">r</span>
    
    <span class="c1"># check if aquired.</span>
    <span class="k">if</span> <span class="n">fd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">fd</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;I have succesfuly aquired the lock !&quot;</span><span class="p">)</span>

<span class="c1"># no need to release anything or to close the file descriptor, </span>
<span class="c1"># with statement takes care of that. let&#39;s print fd and verify that.</span>
<span class="k">print</span> <span class="n">fd</span>
</pre></div>
</div>
</div>
<div class="section" id="locker-main-module">
<h2>Locker main module:<a class="headerlink" href="#locker-main-module" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">pylocker.Locker.</code><code class="descname">Locker</code><span class="sig-paren">(</span><em>filePath</em>, <em>lockPass</em>, <em>mode='a'</em>, <em>lockPath=None</em>, <em>timeout=10</em>, <em>wait=0</em>, <em>deadLock=20</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This is pylocker main class. Locker can be used for general locking purposes and 
more specifically to lock a file from reading or writing to whoever that doesn&#8217;t  
have the lock pass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>filePath (None, path): The file that needs to be locked. When given and a lock 
is aquired, the file will be automatically opened for writing or reading 
depending on the given mode. If None is given, the locker can always be used
for its general purpose as shown in the examples.</li>
<li>lockPass (string): The locking pass.</li>
<li>mode (string): This is file opening mode and it can be any of 
&#8216;r&#8217;,&#8217;r+&#8217;,&#8217;w&#8217;,&#8217;w+&#8217;,&#8217;a&#8217;,&#8217;a+&#8217;. If filePath is None, this argument will not be
discarded.</li>
<li>lockPath (None, path): The locking file path. If None is given the locking file
will be automatically created to &#8216;.lock&#8217; in the filePath directory. If 
filePath is None, &#8216;.lock&#8217; will be created in the current working directory.</li>
<li>timeout (number): The maximum delay or time allowed to successfully set the 
lock. When timeout is exhausted before successfully setting the lock, 
the lock ends up not acquired.</li>
<li>wait (number): The time delay between each attempt to lock. By default it&#8217;s
set to 0 to keeping the aquiring mechanism trying to aquire the lock without 
losing any time waiting. Setting wait to a higher value suchs as 0.05 seconds
or higher can be very useful in special cases when many processes are trying 
to acquire the lock and one of them needs to hold it a release it at a higher
frequency or rate.</li>
<li>deadLock (number): The time delay judging if the lock was left out mistakenly 
after a system crash or other unexpected reasons. Normally Locker is stable 
and takes care of not leaving any locking file hanging even it crashes or it
is forced to stop by a user signal.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<code class="descname">filePath</code></dt>
<dd><p>locker file path</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lockPass</code></dt>
<dd><p>locker pass</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lockPath</code></dt>
<dd><p>locker lock path</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">timeout</code></dt>
<dd><p>locker timeout in seconds</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">wait</code></dt>
<dd><p>locker wait in seconds</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">deadLock</code></dt>
<dd><p>locker deadLock in seconds</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_mode</code><span class="sig-paren">(</span><em>mode</em><span class="sig-paren">)</span></dt>
<dd><p>Set file opening mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>mode (string): This is file opening mode and it can be any of 
r , r+ , w , w+ , a , a+ . If filePath is None, this argument 
will be discarded.<ul>
<li>r : Open text file for reading.  The stream is positioned at the
beginning of the file.</li>
<li>r+ : Open for reading and writing.  The stream is positioned at the
beginning of the file.</li>
<li>w : Truncate file to zero length or create text file for writing.
The stream is positioned at the beginning of the file.</li>
<li>w+ : Open for reading and writing.  The file is created if it does not
exist, otherwise it is truncated.  The stream is positioned at
the beginning of the file.</li>
<li>a : Open for writing.  The file is created if it does not exist.  The
stream is positioned at the end of the file.  Subsequent writes
to the file will always end up at the then current end of file,
irrespective of any intervening fseek(3) or similar.</li>
<li>a+ : Open for reading and writing.  The file is created if it does not
exist. The stream is positioned at the end of the file.  Subsequent
writes to the file will always end up at the then current
end of file, irrespective of any intervening fseek(3) or similar.</li>
</ul>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_file_path</code><span class="sig-paren">(</span><em>filePath</em><span class="sig-paren">)</span></dt>
<dd><p>Set the file path that needs to be locked.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>filePath (None, path): The file that needs to be locked. When given and a lock 
is aquired, the file will be automatically opened for writing or reading 
depending on the given mode. If None is given, the locker can always be used
for its general purpose as shown in the examples.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_lock_pass</code><span class="sig-paren">(</span><em>lockPass</em><span class="sig-paren">)</span></dt>
<dd><p>Set the locking pass</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>lockPass (string): The locking pass.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_lock_path</code><span class="sig-paren">(</span><em>lockPath</em><span class="sig-paren">)</span></dt>
<dd><p>Set the managing lock file path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>lockPath (None, path): The locking file path. If None is given the locking file
will be automatically created to &#8216;.lock&#8217; in the filePath directory. If 
filePath is None, &#8216;.lock&#8217; will be created in the current working directory.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_timeout</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span></dt>
<dd><p>set the timeout limit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>timeout (number): The maximum delay or time allowed to successfully set the 
lock. When timeout is exhausted before successfully setting the lock, 
the lock ends up not acquired.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_wait</code><span class="sig-paren">(</span><em>wait</em><span class="sig-paren">)</span></dt>
<dd><p>set the waiting time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>wait (number): The time delay between each attempt to lock. By default it&#8217;s
set to 0 to keeping the aquiring mechanism trying to aquire the lock without 
losing any time waiting. Setting wait to a higher value suchs as 0.05 seconds
or higher can be very useful in special cases when many processes are trying 
to acquire the lock and one of them needs to hold it a release it at a higher
frequency or rate.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_dead_lock</code><span class="sig-paren">(</span><em>deadLock</em><span class="sig-paren">)</span></dt>
<dd><p>Set the dead lock time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>deadLock (number): The time delay judging if the lock was left out mistakenly 
after a system crash or other unexpected reasons. Normally Locker is stable 
and takes care of not leaving any locking file hanging even it crashes or it
is forced to stop by a user signal.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">acquire_lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Try to acquire the lock.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ol class="first last arabic simple">
<li>result (boolean): Whether the lock is succesfully aquired.</li>
<li>code (integer, Exception): Integer code indicating the reason how the
lock was successfully set or unsuccessfully aquired. When setting the 
lock generates an error, this will be catched and returned in a message
Exception code.<ol class="arabic">
<li>0: Lock is successfully set for normal reasons, In this case result 
is True.</li>
<li>1: Lock was already set, no need to set it again. In this case result  
is True.</li>
<li>2: Old and forgotten lock is found and removed. New lock is 
successfully set, In this case result is True.</li>
<li>3: Lock was not successfully set before timeout. In this case result 
is False.</li>
<li>Exception: Lock was not successfully set because of an unexpected error.
The error is catched and returned in this Exception. In this case 
result is False.</li>
</ol>
</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">release_lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Release the lock when set and close file descriptor if opened.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">acquire</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Alias to acquire_lock</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Alias to release_lock</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Bachir Aoun.
      
    </div>

    
    <a href="https://github.com/bachiraoun/pylocker" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>